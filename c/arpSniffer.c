#include "stdio.h"
#include "stdlib.h"
#include "pcap.h"
#include "string.h"

void print_available_interfaces()
{
    char error[PCAP_ERRBUF_SIZE];
    pcap_if_t *interfaces, *temp;
    int i = 0;
    if (pcap_findalldevs(&interfaces, error) == -1)
    {
        printf("Cannot Acquire the devices: %s\n", error);
        exit(1);
    }
    printf("The Available Interfaces are:\n");
    for (temp = interfaces; temp; temp = temp->next)
    {
        printf("#%d => %s - %s\n", ++i, temp->name, temp->description);
    }
}

void print_help(char *bin)
{
    printf("\n\nARP Spoof Detector\n");
    printf("Version: %s and the Tool version is 1.0.0\n", pcap_lib_version());
    printf("Usage: arpSniffer [OPTION]...\n");
    printf("Eg. %s -i <interface>[You can look for the available interfaces using -l (or) --lokup]\n", bin);
    printf("ARP Sniffer\n");
    printf("\n");
    printf("  -h, --help\t\t\tPrint this help\n");
    printf("  -v, --version\t\t\tPrint version information\n");
    printf("  -i, --interface=INTERFACE\tSpecify the interface to sniff on\n");
    printf("\n\n___  ____________   ___________ _____  ___________ ___________  \n");
    printf("End of Program\n");
    exit(1);
}
void print_version()
{
    printf("    ___  ____________   ___________ _____  ___________ ___________  \n");
    printf("   / _ \\| ___ \\ ___ \\ /  ___| ___ \\  _  ||  _  |  ___|  ___| ___ \\ \n");
    printf("  / /_\\ \\| |_/ / |_/ / \\ `--.| |_/ / | | || | | | |_  | |__ | |_/ / \n");
    printf("  |  _  ||    /|  __/   `--. \\  __/| | | || | | |  _| |  __||    /  \n");
    printf("  | | | || |\\ \\| |     /\\__/ / |   \\ \\_/ /\\ \\_/ / |   | |___| |\\ \\  \n");
    printf("  \\_| |_/\\_| \\\\_|     \\____/\\_|    \\___/  \\___/\\_|   \\____/\\_| \\_| \n");
    printf("                                                                    \n");
    printf("                                                                    \n");
    printf("    ___   _   _______                                               \n");
    printf("   / _ \\ | \\ | |  _  \\                                              \n");
    printf("  / /_\\ \\|  \\| | | | |                                              \n");
    printf("  |  _  || . ` | | | |                                              \n");
    printf("  | | | || |\\  | |/ /                                               \n");
    printf("  \\_| |_/\\_| \\_/___/                                                \n");
    printf("                                                                    \n");
    printf("                                                                    \n");
    printf("  ______ _____ _____ _____ _____ _____ ___________                  \n");
    printf("  |  _  \\  ___|_   _|  ___/  __ \\_   _|  _  | ___ \\                 \n");
    printf("  | | | | |__   | | | |__ | /  \\/ | | | | | | |_/ /                 \n");
    printf("  | | | |  __|  | | |  __|| |     | | | | | |    /                  \n");
    printf("  | |/ /| |___  | | | |___| \\__/\\ | | \\ \\_/ / |\\ \\                  \n");
    printf("  |___/ \\____/  \\_/ \\____/ \\____/ \\_/  \\___/\\_| \\_|                 \n");
    printf("\nVersion: %s and the Tool version is 1.0.0\n", pcap_lib_version());
}
int main(int argc, char *argv[])
{
    printf("___  ____________   ___________ _____  ___________ ___________  \n\n");
    if (argc < 2 || strcmp("-h", argv[1]) == 0 || strcmp("--help", argv[1]) == 0)
    {
        print_version();
        print_help(argv[0]);
    }
    else if (strcmp("-v", argv[1]) == 0 || strcmp("--version", argv[1]) == 0)
    {
        print_version();
    }
    else if (strcmp("-i", argv[1]) == 0 || strcmp("--interface", argv[1]) == 0)
    {
        print_available_interfaces();
    }
    else if (strcmp("-l", argv[1]) == 0 || strcmp("--lookup", argv[1]) == 0)
    {
        print_available_interfaces();
    }
    else
    {
        print_help(argv[0]);
    }
    printf("\n\n___  ____________   ___________ _____  ___________ ___________  \n");
    printf("End of Program\n");
    return 0;
}